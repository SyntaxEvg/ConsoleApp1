2025-11-26T10:46:23.0075013+03:00 [--16.0.2-]  ***** Starting HAS Identity Provider - Logs initialized with mode Verbose.
2025-11-26T10:46:23.0197600+03:00 [--16.0.2-]  Starting module 2025-HAS Identity Provider - Mode : "Production"
2025-11-26T10:46:23.1844792+03:00 [--16.0.2-]  Using 'https://vmshqeat04.npr.nornick.ru/uas' as openid authority
2025-11-26T10:46:23.2355564+03:00 [--16.0.2-]  ##################################################
!!! НОВАЯ ВЕРСИЯ КОДА v5 !!!
##################################################
=== EnsureSeedData: НАЧАЛО ===
Шаг 1: BuildServiceProvider...
Шаг 1: BuildServiceProvider - OK
Шаг 2: Получение ApplicationDbContext...
Шаг 2: ApplicationDbContext = OK
Шаг 3: Получение ConfigurationDbContext...
Шаг 3: ConfigurationDbContext = OK
Шаг 4: Получение ILogger...
Шаг 4: ILogger = OK
Шаг 5: Проверка IsInMemory...
Шаг 5.1: context.Database = OK
Шаг 5: IsInMemory = False
=== Режим SQL Server (не InMemory) ===
Шаг 6: Получение ICryptoService...
Шаг 6: ICryptoService = OK
Шаг 7: Вызов MigrateDatabase...
##################################################
!!! MigrateDatabase НАЧАЛО v5 !!!
##################################################
=== MigrateDatabase: НАЧАЛО ===
Проверка Standalone режима...
Standalone = False
isStandalone = False
=== SQL Server миграция ===
Миграция 1: Получение ApplicationDbContext...
Миграция 1: ApplicationDbContext = OK
Миграция 1: Проверка Database...
Миграция 1: Database = OK
Миграция 1: Проверка ProviderName...
Миграция 1: ProviderName = Microsoft.EntityFrameworkCore.SqlServer
Миграция 1: Проверка ConnectionString...
Миграция 1: ConnectionString = OK (длина: 111)
ConnectionString (masked): Data Source=vmshqeatdb03;User ID=MS-HQ-Srvhopexusr_p;Password=***;encrypt=false;Database=HAS_2025;
Microsoft.Data.SqlClient Version: 5.0.0.0
Microsoft.Data.SqlClient Location: C:\MEGA\Hopex Application Server\2025\.shadowFiles\has.uas\16.0.2+53\Microsoft.Data.SqlClient.dll
>>> Проверка ConnectionString через SqlConnectionStringBuilder...
ОШИБКА в: SqlConnectionStringBuilder
Message: Object reference not set to an instance of an object.
Type: System.NullReferenceException
--- FULL EXCEPTION ---
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlConnectionStringBuilder.get_DataSource()
   at Mega.Has.Modules.UAS.SeedData.MigrateDatabase(ILogger logger, IServiceProvider services, ICryptoService cryptoService) in C:\DotnetFolder\source\HAS.Modules.UAS-master\HAS.Modules.UAS\Mega\Has\Modules\UAS\SeedData.cs:line 289
--- END FULL EXCEPTION ---
ОШИБКА в: MigrateDatabase -> ApplicationDbContext.Migrate()
Message: Object reference not set to an instance of an object.
Type: System.NullReferenceException
--- FULL EXCEPTION ---
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlConnectionStringBuilder.get_DataSource()
   at Mega.Has.Modules.UAS.SeedData.MigrateDatabase(ILogger logger, IServiceProvider services, ICryptoService cryptoService) in C:\DotnetFolder\source\HAS.Modules.UAS-master\HAS.Modules.UAS\Mega\Has\Modules\UAS\SeedData.cs:line 289
--- END FULL EXCEPTION ---
ОШИБКА в: MigrateDatabase -> Главный блок
Message: Object reference not set to an instance of an object.
Type: System.NullReferenceException
--- FULL EXCEPTION ---
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlConnectionStringBuilder.get_DataSource()
   at Mega.Has.Modules.UAS.SeedData.MigrateDatabase(ILogger logger, IServiceProvider services, ICryptoService cryptoService) in C:\DotnetFolder\source\HAS.Modules.UAS-master\HAS.Modules.UAS\Mega\Has\Modules\UAS\SeedData.cs:line 289
--- END FULL EXCEPTION ---
ОШИБКА в: EnsureSeedData -> Блок SQL Server
Message: Object reference not set to an instance of an object.
Type: System.NullReferenceException
--- FULL EXCEPTION ---
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.Data.SqlClient.SqlConnectionStringBuilder.get_DataSource()
   at Mega.Has.Modules.UAS.SeedData.MigrateDatabase(ILogger logger, IServiceProvider services, ICryptoService cryptoService) in C:\DotnetFolder\source\HAS.Modules.UAS-master\HAS.Modules.UAS\Mega\Has\Modules\UAS\SeedData.cs:line 289
   at Mega.Has.Modules.UAS.SeedData.EnsureSeedData(IServiceCollection serviceCollection, IClusterConfiguration serverConfigurations, AuthenticationBuilder authenticationBuilder) in C:\DotnetFolder\source\HAS.Modules.UAS-master\HAS.Modules.UAS\Mega\Has\Modules\UAS\SeedData.cs:line 138
--- END FULL EXCEPTION ---
Закрытие соединения с БД...
ОШИБКА в: EnsureSeedData -> Главный блок
Message: Object reference not set to an instance of an object.
Type: System.NullReferenceException
--- FULL EXCEPTION ---
System.NullReferenceException: Object reference not set to an instance of an object.at Microsoft.Data.SqlClient.SqlConnectionStringBuilder.get_DataSource()at Mega.Has.Modules.UAS.SeedData.MigrateDatabase(ILogger logger, IServiceProvider services, ICryptoService cryptoService) in C:\DotnetFolder\source\HAS.Modules.UAS-master\HAS.Modules.UAS\Mega\Has\Modules\UAS\SeedData.cs:line 289at Mega.Has.Modules.UAS.SeedData.EnsureSeedData(IServiceCollection serviceCollection, IClusterConfiguration serverConfigurations, AuthenticationBuilder authenticationBuilder) in C:\DotnetFolder\source\HAS.Modules.UAS-master\HAS.Modules.UAS\Mega\Has\Modules\UAS\SeedData.cs:line 138
--- END FULL EXCEPTION ---
Unhandled exception
