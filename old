using System;
using System.Collections.Generic;
using System.Runtime.CompilerServices;
using Easy_Password_Validator;
using Easy_Password_Validator.Models;
using Mega.Has.Modules.UAS.Models;

namespace Mega.Has.Modules.UAS.Hopex
{
	// Token: 0x0200009A RID: 154
	public class PasswordValidator
	{
		// Token: 0x0600066F RID: 1647 RVA: 0x000165E0 File Offset: 0x000147E0
		[return: TupleElementNames(new string[] { "pass", "score" })]
		public ValueTuple<bool, int> Validate(string password, IEnumerable<string> contextualWords = null, UasSettings options = null)
		{
			if (string.IsNullOrEmpty(password))
			{
				return new ValueTuple<bool, int>(false, 0);
			}
			if (options == null)
			{
				options = new UasSettings();
			}
			PasswordRequirements requirements = new PasswordRequirements
			{
				RequireDigit = options.RequireDigit,
				RequireLowercase = options.RequireLowercase,
				RequireUppercase = options.RequireUppercase,
				RequirePunctuation = options.RequireNonAlphanumeric,
				MinUniqueCharacters = options.RequiredUniqueChars,
				MinLength = options.RequiredLength,
				ExitOnFailure = true,
				MaxNeighboringCharacter = 5
			};
			PasswordValidatorService passwordValidator = new PasswordValidatorService(requirements, null, false);
			if (contextualWords != null)
			{
				passwordValidator.AddTest(new TestReservedWords(contextualWords));
			}
			return new ValueTuple<bool, int>(passwordValidator.TestAndScore(password, null, null), passwordValidator.Score);
		}
	}
}
