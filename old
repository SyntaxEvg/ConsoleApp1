define('WP_HTTP_BLOCK_EXTERNAL', true);
sudo nano /var/www/wp-content/mu-plugins/log-blocked-requests.php
// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
add_filter('pre_http_request', function($preempt, $parsed_args, $url) {
    // –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω WP_HTTP_BLOCK_EXTERNAL
    if (defined('WP_HTTP_BLOCK_EXTERNAL') && WP_HTTP_BLOCK_EXTERNAL) {
        $host = parse_url($url, PHP_URL_HOST);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫
        $allowed = defined('WP_ACCESSIBLE_HOSTS') ? explode(',', WP_ACCESSIBLE_HOSTS) : array();
        $is_allowed = false;
        foreach ($allowed as $allowed_host) {
            if (strpos($host, trim($allowed_host)) !== false) {
                $is_allowed = true;
                break;
            }
        }
        
        // –õ–æ–≥–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
        if (!$is_allowed) {
            file_put_contents('/var/log/wordpress-blocked.log', 
                date('[Y-m-d H:i:s] ') . sprintf(
                    "üö´ BLOCKED: %s\n   Host: %s\n   Method: %s\n\n",
                    $url,
                    $host,
                    isset($parsed_args['method']) ? $parsed_args['method'] : 'GET'
                ),
                FILE_APPEND
            );
        }
    }
    
    return $preempt;
}, 10, 3);

sudo touch /var/log/wordpress-blocked.log
sudo chmod 666 /var/log/wordpress-blocked.log
sudo chown nginx:nginx /var/log/wordpress-blocked.log

tail -f /var/log/wordpress-blocked.log
